---
title: "Gonzalez - analysis (MCTE)"
author: "roko"
date: "9/8/2023"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, python.reticulate = FALSE)
```

# Data and source
## Info  

```{remark}
Publication: https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-020-07167-9
Assembly: https://www.ncbi.nlm.nih.gov/datasets/genome/GCA_015099795.1/
BLAST https://blast.ncbi.nlm.nih.gov/doc/blast-help/downloadblastdata.html#downloadblastdata
manual https://www.ncbi.nlm.nih.gov/books/NBK279690/
```

# Download
```{bash eval=FALSE}
datasets download genome accession PRJDB8495
unzip ncbi_dataset.zip
# proper format, convert to upper case, rename
reader-fasta.py ncbi_dataset/data/GCA_015099795.1/GCA_015099795.1_ASM1509979v1_genomic.fna |fasta-formatter-fasta.py --upper | fasta-writter.py > E.histolytica.fa
# overview of all contigs/chromosomes
cat E.histolytica.fa|grep '>'|perl -pe 's/>//'|perl -pe 's/\n/ /g'
#AP023109.1 AP023110.1 AP023111.1 AP023112.1 AP023113.1 AP023114.1 AP023115.1 AP023116.1 AP023117.1 AP023118.1 AP023119.1 AP023120.1 AP023121.1 AP023122.1 AP023123.1 AP023124.1 AP023125.1 AP023126.1 AP023127.1 AP023128.1 AP023129.1 AP023130.1 AP023131.1 AP023132.1 AP023133.1 AP023134.1 AP023135.1 AP023136.1 AP023137.1 AP023138.1 AP023139.1 AP023140.1 AP023141.1 AP023142.1 AP023143.1 AP023144.1 AP023145.1 AP023146.1 AP023147.1  
```

## STAT
Source: Uniprot.org

**STAT3**
```{bash eval=FALSE}
>STAT3_HUMAN
MAQWNQLQQLDTRYLEQLHQLYSDSFPMELRQFLAPWIESQDWAYAASKESHATLVFHNL
LGEIDQQYSRFLQESNVLYQHNLRRIKQFLQSRYLEKPMEIARIVARCLWEESRLLQTAA
TAAQQGGQANHPTAAVVTEKQQMLEQHLQDVRKRVQDLEQKMKVVENLQDDFDFNYKTLK
SQGDMQDLNGNNQSVTRQKMQQLEQMLTALDQMRRSIVSELAGLLSAMEYVQKTLTDEEL
ADWKRRQQIACIGGPPNICLDRLENWITSLAESQLQTRQQIKKLEELQQKVSYKGDPIVQ
HRPMLEERIVELFRNLMKSAFVVERQPCMPMHPDRPLVIKTGVQFTTKVRLLVKFPELNY
QLKIKVCIDKDSGDVAALRGSRKFNILGTNTKVMNMEESNNGSLSAEFKHLTLREQRCGN
GGRANCDASLIVTEELHLITFETEVYHQGLKIDLETHSLPVVVISNICQMPNAWASILWY
NMLTNNPKNVNFFTKPPIGTWDQVAEVLSWQFSSTTKRGLSIEQLTTLAEKLLGPGVNYS
GCQITWAKFCKENMAGKGFSFWVWLDNIIDLVKKYILALWNEGYIMGFISKERERAILST
KPPGTFLLRFSESSKEGGVTFTWVEKDISGKTQIQSVEPYTKQQLNNMSFAEIIMGYKIM
DATNILVSPLVYLYPDIPKEEAFGKYCRPESQEHPEADPGSAAPYLKTKFICVTPTTCSN
TIDLPMSPRTLDSLMQFGNNGEGAEPSAGGQFESLTFDMELTSECATSPM
```

**STAT5B**
```{bash eval=FALSE}
>STA5B_HUMAN
MAVWIQAQQLQGEALHQMQALYGQHFPIEVRHYLSQWIESQAWDSVDLDNPQENIKATQL
LEGLVQELQKKAEHQVGEDGFLLKIKLGHYATQLQNTYDRCPMELVRCIRHILYNEQRLV
REANNGSSPAGSLADAMSQKHLQINQTFEELRLVTQDTENELKKLQQTQEYFIIQYQESL
RIQAQFGPLAQLSPQERLSRETALQQKQVSLEAWLQREAQTLQQYRVELAEKHQKTLQLL
RKQQTIILDDELIQWKRRQQLAGNGGPPEGSLDVLQSWCEKLAEIIWQNRQQIRRAEHLC
QQLPIPGPVEEMLAEVNATITDIISALVTSTFIIEKQPPQVLKTQTKFAATVRLLVGGKL
NVHMNPPQVKATIISEQQAKSLLKNENTRNDYSGEILNNCCVMEYHQATGTLSAHFRNMS
LKRIKRSDRRGAESVTEEKFTILFESQFSVGGNELVFQVKTLSLPVVVIVHGSQDNNATA
TVLWDNAFAEPGRVPFAVPDKVLWPQLCEALNMKFKAEVQSNRGLTKENLVFLAQKLFNN
SSSHLEDYSGLSVSWSQFNRENLPGRNYTFWQWFDGVMEVLKKHLKPHWNDGAILGFVNK
QQAHDLLINKPDGTFLLRFSDSEIGGITIAWKFDSQERMFWNLMPFTTRDFSIRSLADRL
GDLNYLIYVFPDRPKDEVYSKYYTPVPCESATAKAVDGYVKPQIKQVVPEFVNASADAGG
GSATYMDQAPSPAVCPQAHYNMYPQNPDSVLDTDGDFDLEDTMDVARRVEELLGRPMDSQ
WIPHAQS
```

# BLAST
```{bash eval=FALSE}
# inspiration https://dbsloan.github.io/TS2019/exercises/local_blast.html
# make blast database
makeblastdb -in E.histolytica.fa -dbtype nucl  
# use tblastn
tblastn -query STAT3.fasta -db bdb/E.histolytica.fa -out out/stat3.txt
tblastn -query STAT5B.fasta -db bdb/E.histolytica.fa -out out/stat5b.txt
```

# Results:
# STAT3 - a single lousy hit
```{remark}
>AP023110.1
Length=1662649

 Score = 29.3 bits (64),  Expect = 9.5, Method: Compositional matrix adjust.
 Identities = 17/50 (34%), Positives = 27/50 (54%), Gaps = 7/50 (14%)
 Frame = +1

Query  551     KENMAGKGFSFWVWLDN--IIDLVKKYILAL-----WNEGYIMGFISKER  593
               +E   GKG   ++WL N  +I+L+  +  AL       +G  +GFIS+ R
Sbjct  710086  RERKNGKGVGNYIWLKNKVVIELIDSFSNALLYQFHLKKGDAIGFISRNR  710235
```

# STAT5B - two hits
```{remark}
>AP023114.1
Length=1507152

 Score = 30.4 bits (67),  Expect = 4.5, Method: Compositional matrix adjust.
 Identities = 13/41 (32%), Positives = 23/41 (56%), Gaps = 4/41 (10%)
 Frame = +3

Query  498      VPDKVLWPQLCEALNMKFKAEVQSNRGLTKENLVFLAQKLF  538
                +PD++LW   C+  N  +    +SN    ++N +F+  KLF
Sbjct  1143087  LPDEILWENFCKYFNKSYSTTAESNY---RKN-IFMVCKLF  1143197


>AP023120.1
Length=1168676

 Score = 29.6 bits (65),  Expect = 8.5, Method: Compositional matrix adjust.
 Identities = 25/77 (32%), Positives = 34/77 (44%), Gaps = 12/77 (16%)
 Frame = +2

Query  349     AATVRLLVGGKLNVHMNPPQVKATIISEQQAKSLLKNENTRND-YSG---EILNNCCVME  404
               AAT+ +    +LNV+ N   + A I+S            TR+D Y G   E+LNN  V E
Sbjct  873710  AATIYVYGSYRLNVYGNNSDIDACIVSNSTI--------TRDDFYDGLYAELLNNPDVKE  873865

Query  405     YHQATGTLSAHFRNMSL  421
                 Q     S H   + L
Sbjct  873866  LKQIPSKRSPHLSMIYL  873916
```








